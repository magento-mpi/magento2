<?xml version="1.0"?>
<!--
/**
 * Magento Enterprise Edition
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Magento Enterprise Edition License
 * that is bundled with this package in the file LICENSE_EE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://www.magentocommerce.com/license/enterprise-edition
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     default_default
 * @copyright   Copyright (c) 2010 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://www.magentocommerce.com/license/enterprise-edition
 */
-->

<layout>
    <adminhtml_rma_index>
        <reference name="content">
            <block type="Enterprise_Rma_Block_Adminhtml_Rma" name="enterprise_rma" />
        </reference>
    </adminhtml_rma_index>

    <adminhtml_rma_chooseorder>
        <reference name="left">
            <action method="setIsCollapsed"><value>true</value></action>
        </reference>
        <reference name="root">
            <block type="Enterprise_Rma_Block_Adminhtml_Rma_Create" name="content">
                <block type="Enterprise_Rma_Block_Adminhtml_Rma_Create_Form" template="create/form.phtml" name="form">
                    <block type="Enterprise_Rma_Block_Adminhtml_Rma_Create_Order" template="create/order.phtml" name="rma_create_order">
                        <block type="Enterprise_Rma_Block_Adminhtml_Rma_Create_Order_Grid" name="grid" />
                    </block>
                </block>
            </block>
        </reference>
    </adminhtml_rma_chooseorder>

    <adminhtml_rma_addcomment>
        <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_History" template="edit/general/history.phtml" name="comments_history" output="toHtml"/>
    </adminhtml_rma_addcomment>

    <adminhtml_rma_addproductgrid>
        <block type="Enterprise_Rma_Block_Adminhtml_Rma_New_Tab_Items_Order_Grid" name="add_product_grid" output="toHtml"/>
    </adminhtml_rma_addproductgrid>

    <adminhtml_rma_edit>
        <reference name="head">
            <action method="addItem"><type>skin_js</type><name>Mage_Adminhtml::sales/order/shipment/packaging.js</name></action>
            <action method="addItem"><type>skin_js</type><name>Enterprise_Rma::rma.js</name></action>
        </reference>
        <reference name="content">
            <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit" name="enterprise_rma_edit" />
            <block type="Mage_Adminhtml_Block_Template" template="Enterprise_Rma::edit/details.phtml" />
            <block type="Mage_Adminhtml_Block_Template" template="Enterprise_Rma::edit/reason.phtml" />
        </reference>
        <reference name="left">
            <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tabs" name="enterprise_rma_edit_tabs">
                <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General" template="edit/general.phtml" name="enterprise_rma_edit_tab_general">
                    <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_Details" template="edit/general/details.phtml" name="request_details" />
                    <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_Shippingmethod" template="edit/shippingmethod.phtml" name="shipping_method">
                        <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_Shipping_Tracking" name="enterprise_rma_shipment_tracking" template="edit/shipping/tracking.phtml" />
                    </block>
                    <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_Shippingaddress" template="edit/general/shippingaddress.phtml" name="shipping_address" />
                    <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_Returnaddress" template="edit/general/returnadress.phtml" name="return_address" />
                    <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_History" template="edit/general/history.phtml" name="comments_history" />
                </block>
                <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_Items" template="edit/items.phtml" name="enterprise_rma_edit_tab_items">
                    <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_Items_Grid" name="items_grid" />
                </block>
                <action method="addTab"><name>general_section</name><block>enterprise_rma_edit_tab_general</block></action>
                <action method="addTab"><name>items_section</name><block>enterprise_rma_edit_tab_items</block></action>
            </block>
        </reference>
        <reference name="before_body_end">
            <block type="Mage_Adminhtml_Block_Template" template="Enterprise_Rma::edit/mask.phtml" />
            <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Js" template="edit/js.phtml" name="enterprise_rma_js_create" />
        </reference>
    </adminhtml_rma_edit>

    <adminhtml_rma_loadattributes>
        <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Item" name="enterprise_rma_edit_item" output="toHtml" />
    </adminhtml_rma_loadattributes>

    <adminhtml_rma_loadnewattributes>
        <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Item" name="enterprise_rma_edit_item" output="toHtml" />
    </adminhtml_rma_loadnewattributes>

    <adminhtml_rma_loadsplitline>
        <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_Items_Grid" name="enterprise_rma_edit_items_grid" output="toHtml" />
    </adminhtml_rma_loadsplitline>

    <adminhtml_rma_showshippingmethods>
        <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_Shipping_Methods" name="enterprise_rma_shipping_available" output="toHtml" template="edit/shipping/methods.phtml"/>
    </adminhtml_rma_showshippingmethods>

    <adminhtml_rma_getshippingitemsgrid>
        <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_Shipping_Grid" name="enterprise_rma_getshippingitemsgrid" template="edit/shipping/grid.phtml" output="toHtml" />
    </adminhtml_rma_getshippingitemsgrid>

    <adminhtml_rma_psl>
        <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_Shipping_Packaging" name="enterprise_rma_shipment_packaging" template="edit/shipping/popup.phtml" />
    </adminhtml_rma_psl>

    <adminhtml_rma_addtrack>
        <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_Shipping_Tracking" name="shipment_tracking" template="edit/shipping/tracking.phtml" output="toHtml" />
    </adminhtml_rma_addtrack>

    <adminhtml_rma_removetrack>
        <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_Shipping_Tracking" name="shipment_tracking" template="edit/shipping/tracking.phtml" output="toHtml" />
    </adminhtml_rma_removetrack>

    <adminhtml_rma_new>
        <reference name="head">
            <action method="addItem"><type>skin_js</type><name>Enterprise_Rma::rma.js</name></action>
        </reference>
        <reference name="content">
            <block type="Enterprise_Rma_Block_Adminhtml_Rma_New" name="enterprise_rma_new" />
        </reference>
        <reference name="left">
            <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tabs" name="enterprise_rma_edit_tabs">
                <block type="Enterprise_Rma_Block_Adminhtml_Rma_New_Tab_General" template="new/general.phtml" name="enterprise_rma_new_tab_general">
                    <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_Details" template="new/general/details.phtml" name="request_details" />
                    <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_Shippingaddress" template="edit/general/shippingaddress.phtml" name="shipping_address" />
                    <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_Returnaddress" template="edit/general/returnadress.phtml" name="return_address" />
                    <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_History" template="new/general/history.phtml" name="comments_history" />
                    <block type="Enterprise_Rma_Block_Adminhtml_Rma_Edit_Tab_General_History" template="new/general/confirmation.phtml" name="return_confirmation" />
                </block>
                <block type="Enterprise_Rma_Block_Adminhtml_Rma_New_Tab_Items" name="enterprise_rma_new_tab_items" template="new/items.phtml">
                    <block type="Enterprise_Rma_Block_Adminhtml_Rma_New_Tab_Items_Grid" name="rma_items_grid" />
                    <block type="Enterprise_Rma_Block_Adminhtml_Rma_New_Tab_Items_Order_Grid" name="order_items_grid" />
                </block>
                <action method="addTab"><name>general_section</name><block>enterprise_rma_new_tab_general</block></action>
                <action method="addTab"><name>items_section</name><block>enterprise_rma_new_tab_items</block></action>
            </block>
        </reference>
        <reference name="before_body_end">
            <block type="Mage_Adminhtml_Block_Template" template="enterprise/rma/edit/mask.phtml" />
            <block type="Enterprise_Rma_Block_Adminhtml_Product_Bundle_Js" template="enterprise/rma/edit/bundle/js.phtml" name="enterprise_rma_js_create" />
        </reference>
    </adminhtml_rma_new>

    <adminhtml_rma_showbundleitems>
        <block type="Enterprise_Rma_Block_Adminhtml_Product_Bundle_Items" template="enterprise/rma/edit/bundle/bundle.phtml" name="enterprise_rma_bundle" output="toHtml" />
    </adminhtml_rma_showbundleitems>

    <!-- RMA item attributes -->
    <adminhtml_rma_item_attribute_index>
        <reference name="content">
            <block type="Enterprise_Rma_Block_Adminhtml_Rma_Item_Attribute" name="enterprise_rma_item_attribute" />
        </reference>
    </adminhtml_rma_item_attribute_index>

    <adminhtml_rma_item_attribute_edit>
        <update handle="scope_switcher"/>
        <reference name="content">
            <block type="Enterprise_Rma_Block_Adminhtml_Rma_Item_Attribute_Edit" name="enterprise_rma_item_attribute_edit" />
        </reference>
        <reference name="left">
            <block type="Enterprise_Rma_Block_Adminhtml_Rma_Item_Attribute_Edit_Tabs" name="enterprise_rma_item_attribute_edit_tabs">
                <block type="Enterprise_Rma_Block_Adminhtml_Rma_Item_Attribute_Edit_Tab_Main" name="enterprise_rma_item_attribute_edit_tab_general" />
                <action method="addTab"><name>general</name><block>enterprise_rma_item_attribute_edit_tab_general</block></action>
                <block type="Enterprise_Rma_Block_Adminhtml_Rma_Item_Attribute_Edit_Tab_Options" name="enterprise_rma_item_attribute_edit_tab_options" />
                <action method="addTab"><name>options</name><block>enterprise_rma_item_attribute_edit_tab_options</block></action>
            </block>
        </reference>
        <reference name="js">
            <block type="Enterprise_Rma_Block_Adminhtml_Rma_Item_Attribute_Edit_Js" template="attribute/js.phtml" />
        </reference>
    </adminhtml_rma_item_attribute_edit>

    <adminhtml_rma_item_attribute_new>
        <remove name="website_switcher" />
    </adminhtml_rma_item_attribute_new>

    <adminhtml_sales_order_view>
        <reference name="sales_order_tabs">
            <block type="Enterprise_Rma_Block_Adminhtml_Order_View_Tab_Rma" name="enterprise_rma_order_view_tab_rma" after="order_shipments">
                <block type="Enterprise_Rma_Block_Adminhtml_Rma" name="enterprise_rma" />
            </block>
            <action method="addTabAfter"><name>order_rma</name><block>enterprise_rma_order_view_tab_rma</block><after>order_shipments</after></action>
        </reference>
        <reference name="sales_order_edit">
            <block name="rma_buttons" type="Enterprise_Rma_Block_Adminhtml_Order_View_Buttons">
                <action method="addButtons"></action>
            </block>
        </reference>
    </adminhtml_sales_order_view>
    <adminhtml_customer_edit>
        <reference name="customer_edit_tabs">
            <block type="Enterprise_Rma_Block_Adminhtml_Customer_Edit_Tab_Rma" name="customer_edit_tab_rma" after="orders">
                <block type="Enterprise_Rma_Block_Adminhtml_Rma" name="enterprise_rma" />
            </block>
            <action method="addTabAfter"><name>customer_edit_tab_rma</name><block>customer_edit_tab_rma</block><after>orders</after></action>
        </reference>
    </adminhtml_customer_edit>
</layout>
