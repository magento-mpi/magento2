<?xml version="1.0"?>
<!--
/**
 * {license_notice}
 *
 * @copyright   {copyright}
 * @license     {license_link}
 */
-->
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <preference for="Magento\FullPageCache\Model\Processor\RestrictionInterface" type="Magento\FullPageCache\Model\Processor\Restriction" />
    <type name="Magento\FullPageCache\Model\Request\Identifier">
        <arguments>
            <argument name="scopeCode" xsi:type="init_parameter">Magento\Core\Model\App::PARAM_RUN_CODE</argument>
        </arguments>
    </type>
    <type name="Magento\FullPageCache\Model\Processor">
        <arguments>
            <argument name="storeManager" xsi:type="object">Magento\Core\Model\StoreManager\Proxy</argument>
            <argument name="metadata" xsi:type="object">Magento\FullPageCache\Model\Metadata\Proxy</argument>
            <argument name="requestIdentifier" xsi:type="object">Magento\FullPageCache\Model\Request\Identifier\Proxy</argument>
            <argument name="allowedCache" xsi:type="array">
                <item name="cms" xsi:type="string">Magento\FullPageCache\Model\Processor\DefaultProcessor</item>
                <item name="catalog" xsi:type="array">
                    <item name="category" xsi:type="array">
                        <item name="view" xsi:type="string">Magento\FullPageCache\Model\Processor\Category</item>
                    </item>
                    <item name="product" xsi:type="array">
                        <item name="view" xsi:type="string">Magento\FullPageCache\Model\Processor\Product</item>
                    </item>
                </item>
            </argument>
        </arguments>
    </type>
    <type name="Magento\FullPageCache\Model\DesignPackage\Rules">
        <arguments>
            <argument name="designChange" xsi:type="object">Magento\Core\Model\Design\Proxy</argument>
        </arguments>
    </type>
    <type name="Magento\Log\Model\Visitor">
        <arguments>
            <argument name="ignoredUserAgents" xsi:type="array">
                <item name="cache_crawler" xsi:type="string">MagentoCrawler</item>
            </argument>
        </arguments>
    </type>
    <type name="Magento\App\Response">
        <plugin name="pageCache" type="Magento\FullPageCache\Model\Response\Plugin" />
    </type>
    <type name="Magento\FullPageCache\Model\Observer">
        <arguments>
            <argument name="ctlgProdCompare" xsi:type="object">Magento\Catalog\Helper\Product\Compare\Proxy</argument>
            <argument name="processor" xsi:type="object">Magento\FullPageCache\Model\Processor\Proxy</argument>
            <argument name="cookie" xsi:type="object">Magento\FullPageCache\Model\Cookie\Proxy</argument>
        </arguments>
    </type>
    <type name="Magento\FullPageCache\Model\Validator">
        <arguments>
            <argument name="changeDependencies" xsi:type="array">
                <item name="catalog_product" xsi:type="string">Magento\Catalog\Model\Product</item>
                <item name="catalog_category" xsi:type="string">Magento\Catalog\Model\Category</item>
                <item name="catalog_eav_attribute" xsi:type="string">Magento\Catalog\Model\Resource\Eav\Attribute</item>
                <item name="review" xsi:type="string">Magento\Review\Model\Review</item>
                <item name="cms_hierarchy_node" xsi:type="string">Magento\VersionsCms\Model\Hierarchy\Node</item>
                <item name="banner" xsi:type="string">Magento\Banner\Model\Banner</item>
                <item name="core_store_group" xsi:type="string">Magento\Core\Model\Store\Group</item>
            </argument>
            <argument name="deleteDependencies" xsi:type="array">
                <item name="catalog_category" xsi:type="string">Magento\Catalog\Model\Category</item>
                <item name="catalog_eav_attribute" xsi:type="string">Magento\Catalog\Model\Resource\Eav\Attribute</item>
                <item name="review" xsi:type="string">Magento\Review\Model\Review</item>
                <item name="cms_hierarchy_node" xsi:type="string">Magento\VersionsCms\Model\Hierarchy\Node</item>
                <item name="banner" xsi:type="string">Magento\Banner\Model\Banner</item>
                <item name="core_store_group" xsi:type="string">Magento\Core\Model\Store\Group</item>
            </argument>
        </arguments>
    </type>
</config>
