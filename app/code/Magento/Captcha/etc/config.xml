<?xml version="1.0"?>
<!--
/**
 * {license_notice}
 *
 * @category    Magento
 * @package     Magento_Captcha
 * @copyright   {copyright}
 * @license     {license_link}
 */
-->
<config>
    <global>
        <resources>
            <captcha_setup>
                <setup>
                    <module>Magento_Captcha</module>
                </setup>
            </captcha_setup>
        </resources>
        <events>
            <controller_action_predispatch_customer_account_loginPost>
                <observers>
                    <captcha>
                        <class>Magento_Captcha_Model_Observer</class>
                        <method>checkUserLogin</method>
                    </captcha>
                </observers>
            </controller_action_predispatch_customer_account_loginPost>
            <controller_action_predispatch_customer_account_createpost>
                <observers>
                    <captcha>
                        <class>Magento_Captcha_Model_Observer</class>
                        <method>checkUserCreate</method>
                    </captcha>
                </observers>
            </controller_action_predispatch_customer_account_createpost>
            <admin_user_authenticate_before>
                <observers>
                    <captcha>
                        <class>Magento_Captcha_Model_Observer</class>
                        <method>checkUserLoginBackend</method>
                    </captcha>
                </observers>
            </admin_user_authenticate_before>
            <controller_action_predispatch_checkout_onepage_saveBilling>
                <observers>
                    <captcha_guest>
                        <class>Magento_Captcha_Model_Observer</class>
                        <method>checkGuestCheckout</method>
                    </captcha_guest>
                    <captcha_register>
                        <class>Magento_Captcha_Model_Observer</class>
                        <method>checkRegisterCheckout</method>
                    </captcha_register>
                </observers>
            </controller_action_predispatch_checkout_onepage_saveBilling>
            <customer_customer_authenticated>
                <observers>
                    <captcha_reset_attempt>
                        <class>Magento_Captcha_Model_Observer</class>
                        <method>resetAttemptForFrontend</method>
                    </captcha_reset_attempt>
                </observers>
            </customer_customer_authenticated>
            <backend_auth_user_login_success>
                <observers>
                    <captcha_reset_attempt>
                        <class>Magento_Captcha_Model_Observer</class>
                        <method>resetAttemptForBackend</method>
                    </captcha_reset_attempt>
                </observers>
            </backend_auth_user_login_success>
        </events>
    </global>
    <frontend>
        <events>
            <controller_action_predispatch_contacts_index_post>
                <observers>
                    <captcha_contact_us_form>
                        <class>Magento_Captcha_Model_Observer</class>
                        <method>checkContactUsForm</method>
                    </captcha_contact_us_form>
                </observers>
            </controller_action_predispatch_contacts_index_post>
        </events>
        <routers>
            <captcha>
                <use>standard</use>
                <args>
                    <module>Magento_Captcha</module>
                    <frontName>captcha</frontName>
                </args>
            </captcha>
        </routers>
        <translate>
            <modules>
                <Magento_Captcha>
                    <files>
                        <default>Magento_Captcha.csv</default>
                    </files>
                </Magento_Captcha>
            </modules>
        </translate>
    </frontend>
    <admin>
        <routers>
            <adminhtml>
                <args>
                    <modules>
                        <captcha>Magento_Captcha_Adminhtml</captcha>
                    </modules>
                </args>
            </adminhtml>
        </routers>
    </admin>
    <adminhtml>
        <translate>
            <modules>
                <Magento_Captcha>
                    <files>
                        <default>Magento_Captcha.csv</default>
                    </files>
                </Magento_Captcha>
            </modules>
        </translate>
        <events>
            <controller_action_predispatch_adminhtml_auth_forgotpassword>
                <observers>
                    <captcha>
                        <class>Magento_Captcha_Model_Observer</class>
                        <method>checkUserForgotPasswordBackend</method>
                    </captcha>
                </observers>
            </controller_action_predispatch_adminhtml_auth_forgotpassword>
            <controller_action_predispatch_customer_account_forgotpasswordpost>
                <observers>
                    <captcha>
                        <class>Magento_Captcha_Model_Observer</class>
                        <method>checkForgotPassword</method>
                    </captcha>
                </observers>
            </controller_action_predispatch_customer_account_forgotpasswordpost>
        </events>
    </adminhtml>
    <default>
        <system>
            <media_storage_configuration>
                <allowed_resources>
                    <captcha_folder>captcha</captcha_folder>
                </allowed_resources>
            </media_storage_configuration>
        </system>
        <admin>
            <captcha>
                <type>default</type>
                <enable>0</enable>
                <font>linlibertine</font>
                <mode>after_fail</mode>
                <forms>backend_forgotpassword</forms>
                <failed_attempts_login>3</failed_attempts_login>
                <failed_attempts_ip>1000</failed_attempts_ip>
                <timeout>7</timeout>
                <length>4-5</length>
                <symbols>ABCDEFGHJKMnpqrstuvwxyz23456789</symbols>
                <case_sensitive>0</case_sensitive>
                <shown_to_logged_in_user />
                <always_for>
                    <backend_forgotpassword>1</backend_forgotpassword>
                </always_for>
            </captcha>
        </admin>
        <customer>
            <captcha>
                <type>default</type>
                <enable>0</enable>
                <font>linlibertine</font>
                <mode>after_fail</mode>
                <forms>user_forgotpassword</forms>
                <failed_attempts_login>3</failed_attempts_login>
                <failed_attempts_ip>1000</failed_attempts_ip>
                <timeout>7</timeout>
                <length>4-5</length>
                <symbols>ABCDEFGHJKMnpqrstuvwxyz23456789</symbols>
                <case_sensitive>0</case_sensitive>
                <shown_to_logged_in_user>
                    <contact_us>1</contact_us>
                </shown_to_logged_in_user>
                <always_for>
                    <user_create>1</user_create>
                    <user_forgotpassword>1</user_forgotpassword>
                    <guest_checkout>1</guest_checkout>
                    <register_during_checkout>1</register_during_checkout>
                    <contact_us>1</contact_us>
                </always_for>
            </captcha>
        </customer>
        <captcha translate="label">
            <fonts>
                <linlibertine>
                    <label>LinLibertine</label>
                    <path>LinLibertineFont/LinLibertine_Bd-2.8.1.ttf</path>
                </linlibertine>
            </fonts>
            <frontend>
                <areas>
                    <user_create>
                        <label>Create user</label>
                    </user_create>
                    <user_login>
                        <label>Login</label>
                    </user_login>
                    <user_forgotpassword>
                        <label>Forgot password</label>
                    </user_forgotpassword>
                    <guest_checkout>
                        <label>Checkout as Guest</label>
                    </guest_checkout>
                    <register_during_checkout>
                        <label>Register during Checkout</label>
                    </register_during_checkout>
                    <contact_us>
                        <label>Contact Us</label>
                    </contact_us>
                </areas>
            </frontend>
            <backend>
                <areas>
                    <backend_login>
                        <label>Admin Login</label>
                    </backend_login>
                    <backend_forgotpassword>
                        <label>Admin Forgot Password</label>
                    </backend_forgotpassword>
                </areas>
            </backend>
        </captcha>
    </default>
    <crontab>
        <jobs>
            <captcha_delete_old_attempts>
                <schedule>
                    <cron_expr>*/30 * * * *</cron_expr>
                </schedule>
                <run>
                    <model>Magento_Captcha_Model_Observer::deleteOldAttempts</model>
                </run>
            </captcha_delete_old_attempts>
            <captcha_delete_expired_images>
                <schedule>
                    <cron_expr>*/10 * * * *</cron_expr>
                </schedule>
                <run>
                    <model>Magento_Captcha_Model_Observer::deleteExpiredImages</model>
                </run>
            </captcha_delete_expired_images>
        </jobs>
    </crontab>
</config>
