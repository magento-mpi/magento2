<?xml version="1.0"?>
<!--
/**
 * {license_notice}
 *
 * @category    Enterprise
 * @package     Enterprise_CatalogPermissions
 * @copyright   {copyright}
 * @license     {license_link}
 */
-->
<config>
    <global>
        <resources>
            <enterprise_catalogpermissions_setup>
                <setup>
                    <module>Enterprise_CatalogPermissions</module>
                    <class>Enterprise_CatalogPermissions_Model_Resource_Setup</class>
                </setup>
            </enterprise_catalogpermissions_setup>
        </resources>
        <index>
            <indexer>
                <catalogpermissions>
                    <model>Enterprise_CatalogPermissions_Model_Permission_Index</model>
                </catalogpermissions>
            </indexer>
        </index>
    </global>
    <adminhtml>
        <events>
            <catalog_category_save_after>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Adminhtml_Observer</class>
                        <method>saveCategoryPermissions</method>
                    </enterprise_catalogpermissions>
                </observers>
            </catalog_category_save_after>
            <category_move>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Adminhtml_Observer</class>
                        <method>reindexCategoryPermissionOnMove</method>
                    </enterprise_catalogpermissions>
                </observers>
            </category_move>
            <store_add>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Adminhtml_Observer</class>
                        <method>reindexProducts</method>
                    </enterprise_catalogpermissions>
                </observers>
            </store_add>
            <website_add>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Adminhtml_Observer</class>
                        <method>reindexProducts</method>
                    </enterprise_catalogpermissions>
                </observers>
            </website_add>
            <customer_group_save_after>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Adminhtml_Observer</class>
                        <method>reindex</method>
                    </enterprise_catalogpermissions>
                </observers>
            </customer_group_save_after>
            <controller_action_postdispatch>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Adminhtml_Observer</class>
                        <method>reindexPermissions</method>
                    </enterprise_catalogpermissions>
                </observers>
            </controller_action_postdispatch>
            <catalog_product_save_after>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Adminhtml_Observer</class>
                        <method>saveProductPermissionIndex</method>
                    </enterprise_catalogpermissions>
                </observers>
            </catalog_product_save_after>
            <adminhtml_catalog_category_tabs>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Adminhtml_Observer</class>
                        <method>addCategoryPermissionTab</method>
                    </enterprise_catalogpermissions>
                </observers>
            </adminhtml_catalog_category_tabs>
            <catalog_product_import_after>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Adminhtml_Observer</class>
                        <method>reindexProducts</method>
                    </enterprise_catalogpermissions>
                </observers>
            </catalog_product_import_after>
            <catalog_product_to_website_change>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Adminhtml_Observer</class>
                        <method>reindexAfterProductAssignedWebsite</method>
                    </enterprise_catalogpermissions>
                </observers>
            </catalog_product_to_website_change>
            <admin_system_config_changed_section_enterprise_catalogpermissions>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Adminhtml_Observer</class>
                        <method>cleanCacheOnConfigChange</method>
                    </enterprise_catalogpermissions>
                </observers>
            </admin_system_config_changed_section_enterprise_catalogpermissions>
            <after_reindex_process_catalog_category_product>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Adminhtml_Observer</class>
                        <method>applyPermissionsAfterReindex</method>
                    </enterprise_catalogpermissions>
                </observers>
            </after_reindex_process_catalog_category_product>
        </events>
    </adminhtml>
    <frontend>
        <events>
            <catalog_product_collection_before_add_count_to_categories>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>applyCategoryPermissionOnProductCount</method>
                    </enterprise_catalogpermissions>
                </observers>
            </catalog_product_collection_before_add_count_to_categories>
            <catalog_product_is_salable_after>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>applyIsSalableToProduct</method>
                    </enterprise_catalogpermissions>
                </observers>
            </catalog_product_is_salable_after>
            <catalog_category_collection_load_after>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>applyCategoryPermissionOnLoadCollection</method>
                    </enterprise_catalogpermissions>
                </observers>
            </catalog_category_collection_load_after>
            <catalog_category_collection_add_is_active_filter>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>applyCategoryPermissionOnIsActiveFilterToCollection</method>
                    </enterprise_catalogpermissions>
                </observers>
            </catalog_category_collection_add_is_active_filter>
            <catalog_category_tree_init_inactive_category_ids>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>applyCategoryInactiveIds</method>
                    </enterprise_catalogpermissions>
                </observers>
            </catalog_category_tree_init_inactive_category_ids>
            <catalog_product_collection_apply_limitations_after>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>applyProductPermissionOnCollection</method>
                    </enterprise_catalogpermissions>
                </observers>
            </catalog_product_collection_apply_limitations_after>
            <catalog_product_collection_load_after>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>applyProductPermissionOnCollectionAfterLoad</method>
                    </enterprise_catalogpermissions>
                </observers>
            </catalog_product_collection_load_after>
            <catalog_controller_product_init_after>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>applyProductPermission</method>
                    </enterprise_catalogpermissions>
                </observers>
            </catalog_controller_product_init_after>
            <review_controller_product_init_after>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>applyProductPermission</method>
                    </enterprise_catalogpermissions>
                </observers>
            </review_controller_product_init_after>
            <catalog_controller_category_init_after>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>applyCategoryPermission</method>
                    </enterprise_catalogpermissions>
                </observers>
            </catalog_controller_category_init_after>
            <checkout_cart_product_add_after>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>checkQuoteItemSetProduct</method>
                    </enterprise_catalogpermissions>
                </observers>
            </checkout_cart_product_add_after>
            <checkout_cart_save_before>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>checkQuotePermissions</method>
                    </enterprise_catalogpermissions>
                </observers>
            </checkout_cart_save_before>
            <controller_action_predispatch_catalogsearch>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>checkCatalogSearchPreDispatch</method>
                    </enterprise_catalogpermissions>
                </observers>
            </controller_action_predispatch_catalogsearch>
            <controller_action_layout_load_before>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>checkCatalogSearchLayout</method>
                    </enterprise_catalogpermissions>
                </observers>
            </controller_action_layout_load_before>
            <rss_catalog_new_xml_callback>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>checkIfProductAllowedInRss</method>
                    </enterprise_catalogpermissions>
                </observers>
            </rss_catalog_new_xml_callback>
            <rss_catalog_special_xml_callback>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>checkIfProductAllowedInRss</method>
                    </enterprise_catalogpermissions>
                </observers>
            </rss_catalog_special_xml_callback>
            <rss_catalog_tagged_item_xml_callback>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>checkIfProductAllowedInRss</method>
                    </enterprise_catalogpermissions>
                </observers>
            </rss_catalog_tagged_item_xml_callback>
            <rss_catalog_category_xml_callback>
                <observers>
                    <enterprise_catalogpermissions>
                        <class>Enterprise_CatalogPermissions_Model_Observer</class>
                        <method>checkIfProductAllowedInRss</method>
                    </enterprise_catalogpermissions>
                </observers>
            </rss_catalog_category_xml_callback>
        </events>
    </frontend>
    <default>
        <catalog>
            <enterprise_catalogpermissions>
                <grant_catalog_category_view>0</grant_catalog_category_view>
                <grant_catalog_product_price>0</grant_catalog_product_price>
                <grant_checkout_items>0</grant_checkout_items>
                <restricted_landing_page>no-route</restricted_landing_page>
                <deny_catalog_search />
                <enabled>0</enabled>
            </enterprise_catalogpermissions>
        </catalog>
    </default>
</config>
