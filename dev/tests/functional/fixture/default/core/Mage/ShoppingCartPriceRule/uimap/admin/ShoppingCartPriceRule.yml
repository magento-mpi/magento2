#
# {license_notice}
#
# @category    Magento
# @package     Mage_ShoppingCartPriceRule
# @subpackage  functional_tests
# @copyright   {copyright}
# @license     {license_link}
#
---
# Promotions and related pages
# 'Shopping Cart Price Rules' page
manage_shopping_cart_price_rules:
    mca: promo_quote/
    click_xpath: //ul[@id='nav']//a[contains(@href, 'promo_quote')]
    title: Shopping Cart Price Rules / Promotions / Marketing / Magento Admin
    uimap:
        form:
            fieldsets:
                -
                    rule_search_grid:
                        xpath: //div[@id='promo_quote_grid']
                        buttons:
                            reset_filter: //button[span='Reset Filter']
                            search: //button[span='Search']
                        fields:
                            filter_id: //input[@id='rule_id']
                            filter_rule_name: //input[@name='name']
                            filter_coupon_code: //input[@name='coupon_code']
                            filter_date_start_from: //input[@name='from_date[from]']
                            filter_date_start_to: //input[@name='from_date[to]']
                            filter_date_expire_from: //input[@name='to_date[from]']
                            filter_date_expire_to: //input[@name='to_date[to]']
                            filter_priority: //input[@name='sort_order']
                            page: //input[@name='page']
                        dropdowns:
                            filter_status: //select[@name='is_active']
                            view_per_page: //select[@name='limit']
                            filter_website: //select[@name='rule_website']
                        pageelements:
                            grid_head: //table[@id='promo_quote_grid_table']//tr[@class='headings']
        buttons:
            add_new_rule: //button[span='Add New Rule']
        messages: &ruleMessages
            enter_greater_than_zero: //*[@class='mage-error' and @for='%fieldId%' and text()='Please enter a number greater than 0 in this field.']
            use_numbers_only: //label[@class='mage-error' and @for='%fieldId%' and contains(.,'Please enter a valid number in this field.')]
            success_deleted_rule: //li[normalize-space(@class)='success-msg' and contains(.,'The rule has been deleted.')]
            success_saved_rule: //li[normalize-space(@class)='success-msg' and contains(.,'The rule has been saved.')]
            error_coupon_code_exists: //li[normalize-space(@class)='error-msg' and contains(.,'Coupon with the same code already exists.')]
            enter_valid_number: "//div[@id='advice-validate-not-negative-number-%fieldId%' and not(contains(@style,'display: none;'))]"
            generic_validation_error: "//div[contains(@id, 'advice-') and contains(@id, '-%fieldId%') and not(contains(@style,'display: none;'))]"
            confirmation_for_delete: Are you sure you want to do this?
            success_generated_coupons: //li[normalize-space(@class)='success-msg' and contains(.,'%qtyGeneratedCoupons% Coupon(s) have been generated')]
            confirmation_for_delete_coupons: Are you sure you want to delete the selected coupon(s)?
            select_coupons_for_delete: Please select items.

create_shopping_cart_price_rule:
    mca: promo_quote/new/
    title: New Rule / Promotions / Marketing / Magento Admin
    uimap:
        form: &createNewRule
            tabs:
                -
                    rule_information: &rule_information
                        xpath: //a[@title='Rule Information']
                        fieldsets:
                            -
                                general_information:
                                    xpath: //fieldset[@id='rule_base_fieldset']
                                    fields:
                                        rule_name: //input[@name='name']
                                        description: //textarea[@name='description']
                                        coupon_code: //input[@name='coupon_code']
                                        uses_per_coupon: //input[@name='uses_per_coupon']
                                        uses_per_customer: //input[@name='uses_per_customer']
                                        from_date: //input[@name='from_date']
                                        to_date: //input[@name='to_date']
                                        priority: //input[@name='sort_order']
                                    dropdowns:
                                        status: //select[@name='is_active']
                                        coupon: //select[@name='coupon_type']
                                        public_in_rss_feed: //select[@name='is_rss']
                                    multiselects:
                                        customer_groups: //select[@name='customer_group_ids[]']
                                        websites: //select[@id='rule_website_ids']
                                    checkboxes:
                                        use_auto_generation: //input[@id='rule_use_auto_generation']
                -
                    rule_conditions: &rule_conditions
                        xpath: //a[@title='Conditions']
                        fieldsets:
                            -
                                apply_for_rule_condition:
                                    xpath: //*[@id='rule_conditions_fieldset']
                                    links:
                                        conditions_aggregator: /*/span[.//select[contains(@name,'aggregator')]]/a
                                        conditions_value: /*/span[.//select[contains(@name,'value')]]/a
                                    dropdowns:
                                        select_conditions_aggregator: //select[@name='rule[conditions][1][aggregator]']
                                        select_conditions_value: //select[@name='rule[conditions][1][value]']
                                    pageelements:
                                        apply_for_rule_condition_row: /ul/li
                            -
                                rule_condition_item:
                                    xpath: //ul[@id='conditions__%condition%__children']
                                    links:
                                        condition_new_child: //ul[@id='conditions__%condition%__children']/li[%key%]//img[contains(@src,'rule_component_add')]
                                        condition_operator: //ul[@id='conditions__%condition%__children']/li[%key%]//span[contains(.//@name,'operator')]/a
                                        condition_value: //ul[@id='conditions__%condition%__children']/li[%key%]/span[contains(.//@name,'value')]/a
                                        condition_aggregator: //ul[@id='conditions__%condition%__children']/li[%key%]/span[.//select[contains(@name,'aggregator')]]/a
                                        condition_attribute: //ul[@id='conditions__%condition%__children']/li[%key%]/span[.//select[contains(@name,'attribute')]]/a
                                        open_chooser: //ul[@id='conditions__%condition%__children']/li[%key%]//img[contains(@src,'rule_chooser_trigger')]
                                        confirm_choice: //ul[@id='conditions__%condition%__children']/li[%key%]//img[contains(@src,'rule_component_apply')]
                                        rule_condition_item_root_category: //ul/div/li[contains(div/a/span,'%rootName%')]
                                        rule_condition_item_sub_category: //*[@id='%parentCategoryId%']/ancestor::li/ul/li[contains(div/a/span,'%subName%') and not(div/a/span/@id='%parentCategoryId%')]
                                        rule_condition_item_expand_category: //*[@id='%parentCategoryId%']/ancestor::div/img[contains(@class,'x-tree-elbow-plus') or contains(@class,'x-tree-elbow-end-plus')]
                                    pageelements:
                                        rule_condition_item_category_text: %categoryXpath%/div/a/span
                                        rule_condition_item_category_index_text: %categoryXpath%[%index%]/div/a/span
                                        rule_condition_item_category_index_link: %categoryXpath%[%index%]/div/a
                                        rule_condition_item_row: /li
                                    dropdowns:
                                        select_condition_new_child: /li[%key%]//span[contains(.//@src,'rule_component_add')]//select
                                        select_condition_operator: /li[%key%]/span[contains(.//@name,'operator')]//select
                                        select_condition_value: /li[%key%]/span[contains(.//@name,'value')]//select
                                        select_condition_aggregator: /li[%key%]/span[.//select[contains(@name,'aggregator')]]//select
                                        select_condition_attribute: /li[%key%]/span[.//select[contains(@name,'attribute')]]//select
                                    fields:
                                        type_condition_value: /li[%key%]/span[contains(.//@name,'value')]//input
                                    buttons:
                                        delete_rule_condition_item: /li[%key%]//img[contains(@src,'rule_component_remove')]
                                    checkboxes:
                                        category: //div[contains(a/span,'%categoryName%')]//input
                -
                    rule_actions: &rule_actions
                        xpath: //a[@title='Actions']
                        fieldsets:
                            -
                                update_prices_using_the_following_information:
                                    xpath: //*[@id='rule_action_fieldset']
                                    fields:
                                        discount_amount: //input[@name='discount_amount']
                                        maximum_qty_discount_is_applied_to: //input[@name='discount_qty']
                                        discount_qty_step: //input[@name='discount_step']
                                    dropdowns:
                                        apply: //select[@name='simple_action']
                                        apply_to_shipping_amount: //select[@name='apply_to_shipping']
                                        free_shipping: //select[@name='simple_free_shipping']
                                        stop_further_rules_processing: //select[@name='stop_rules_processing']
                            -
                                apply_for_rule_action:
                                    xpath: //*[@id='rule_actions_fieldset']
                                    links:
                                        actions_aggregator: /*/span[.//select[contains(@name,'aggregator')]]/a
                                        actions_value: /*/span[.//select[contains(@name,'value')]]/a
                                    dropdowns:
                                        select_actions_aggregator: //select[@name='rule[actions][1][aggregator]']
                                        select_actions_value: //select[@name='rule[actions][1][value]']
                                    pageelements:
                                        apply_for_rule_action_row: /ul/li
                            -
                                rule_action_item:
                                    xpath: //ul[@id='actions__%condition%__children']
                                    links:
                                        action_new_child: //ul[@id='actions__%condition%__children']/li[%key%]//img[contains(@src,'rule_component_add')]
                                        action_operator: //ul[@id='actions__%condition%__children']/li[%key%]//span[contains(.//@name,'operator')]/a
                                        action_value: //ul[@id='actions__%condition%__children']/li[%key%]/span[contains(.//@name,'value')]/a
                                        action_aggregator: //ul[@id='actions__%condition%__children']/li[%key%]/span[.//select[contains(@name,'aggregator')]]/a
                                        action_attribute: //ul[@id='actions__%condition%__children']/li[%key%]/span[.//select[contains(@name,'attribute')]]/a
                                        open_chooser: //ul[@id='actions__%condition%__children']/li[%key%]//img[contains(@src,'rule_chooser_trigger')]
                                        confirm_choice: //ul[@id='actions__%condition%__children']/li[%key%]//img[contains(@src,'rule_component_apply')]
                                        rule_action_item_root_category: //ul/div/li[contains(div/a/span,'%rootName%')]
                                        rule_action_item_sub_category: //*[@id='%parentCategoryId%']/ancestor::li/ul/li[contains(div/a/span,'%subName%') and not(div/a/span/@id='%parentCategoryId%')]
                                        rule_action_item_expand_category: //*[@id='%parentCategoryId%']/ancestor::div/img[contains(@class,'x-tree-elbow-plus') or contains(@class,'x-tree-elbow-end-plus')]
                                    pageelements:
                                        rule_action_item_category_text: %categoryXpath%/div/a/span
                                        rule_action_item_category_index_text: %categoryXpath%[%index%]/div/a/span
                                        rule_action_item_category_index_link: %categoryXpath%[%index%]/div/a
                                        rule_action_item_row: /li
                                    dropdowns:
                                        select_action_new_child: /li[%key%]//span[contains(.//@src,'rule_component_add')]//select
                                        select_action_operator: /li[%key%]/span[contains(.//@name,'operator')]//select
                                        select_action_value: /li[%key%]/span[contains(.//@name,'value')]//select
                                        select_action_aggregator: /li[%key%]/span[.//select[contains(@name,'aggregator')]]//select
                                        select_action_attribute: /li[%key%]/span[.//select[contains(@name,'attribute')]]//select
                                    fields:
                                        type_action_value: /li[%key%]/span[contains(.//@name,'value')]//input
                                    buttons:
                                        delete_rule_action_item: /li[%key%]//img[contains(@src,'rule_component_remove')]
                                    checkboxes:
                                        category: //div[contains(a/span,'%categoryName%')]//input
                -
                    rule_labels: &rule_labels
                        xpath: //a[@title='Labels']
                        fieldsets:
                            -
                                default_label:
                                    xpath: //*[@id='rule_default_label_fieldset']
                                    fields:
                                        default_rule_label: //input[@name='store_labels[0]']
                            -
                                store_view_specific_labels:
                                    xpath: //*[@id='rule_store_labels_fieldset']
                                    fields:
                                        store_view_rule_label: //*[label/span='%storeViewName%']//input
        buttons:
            back: //button[span='Back']
            reset: //button[span='Reset']
            save_rule: //button[@data-ui-id='promo-quote-edit-save-button']
            save_and_continue_edit: //button[@data-ui-id='promo-quote-edit-save-and-continue-edit-button']
        messages: *ruleMessages

edit_shopping_cart_price_rule:
    mca: promo_quote/edit/id/%id%/
    title: %elementTitle% / Promotions / Marketing / Magento Admin
    uimap:
        form:
            tabs:
                -
                    rule_information: *rule_information
                -
                    rule_conditions: *rule_conditions
                -
                    rule_actions: *rule_actions
                -
                    rule_labels: *rule_labels
                -
                    manage_coupon_codes:
                        xpath: //a[@title='Manage Coupon Codes']
                        fieldsets:
                            -
                                coupons_information:
                                    xpath: //*[@id='coupons_information_fieldset']
                                    fields:
                                        coupon_qty: //input[@id='coupons_qty']
                                        code_length: //input[@id='coupons_length']
                                        code_prefix: //input[@id='coupons_prefix']
                                        code_suffix: //input[@id='coupons_suffix']
                                        dash_every_x_characters: //input[@id='coupons_dash']
                                    dropdowns:
                                        code_format: //select[@id='coupons_format']
                                    buttons:
                                        generate: //button[span='Generate']
                                    pageelements:
                                        default_code_length: //input[@id='coupons_length' and @value='%defaultValue%']
                                        default_code_format: //select[@id='coupons_format']//option[@selected='selected' and @value='%defaultValue%']
                                        default_code_prefix: //input[@id='coupons_prefix' and @value='%defaultValue%']
                                        default_code_suffix: //input[@id='coupons_suffix' and @value='%defaultValue%']
                                        default_dash_every_x_characters: //input[@id='coupons_dash' and @value='%defaultValue%']
                            -
                                manage_coupons_grid:
                                    xpath: //div[@id='couponCodesGrid']
                                    buttons:
                                        reset_filter: //button[span='Reset Filter']
                                        search: //button[span='Search']
                                        submit: //button[span='Submit']
                                        export: //button[span='Export']
                                    fields:
                                        filter_coupon_code: //input[@name='code']
                                        filter_created_on_from: //input[@name='created_at[from]']
                                        filter_created_on_to: //input[@name='created_at[to]']
                                        filter_times_used_from: //input[@name='times_used[from]']
                                        filter_times_used_to: //input[@name='times_used[to]']
                                        page: //input[@name='page']
                                    dropdowns:
                                        export_to: //select[@id='couponCodesGrid_export']
                                        filter_used: //select[@id='couponCodesGrid_filter_used']
                                        actions: //select[@id='couponCodesGrid_massaction-select']
                                    pageelements:
                                        grid_head: //div[@id='couponCodesGrid_massaction']
        buttons:
            back: //button[span='Back']
            reset: //button[span='Reset']
            delete_rule: //button[span='Delete Rule' or span='Delete']
            save_rule: //button[@data-ui-id='promo-quote-edit-save-button']
            save_and_continue_edit: //button[@data-ui-id='promo-quote-edit-save-and-continue-edit-button']
        messages: *ruleMessages
